{% extends "layouts/main.html" %}

{% if data.hasErrors %}
  {% set pageName = 'There’s a problem with your data' %}
{% else %}
  {% set pageName = 'Your data can be published' %}
{% endif %}

{% block beforeContent %}
  {{ govukBackLink({
    text: "Back",
    href: "javascript:window.history.back()"
  }) }}
{% endblock %}

{% block content %}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <span class="govuk-caption-l">
        {% if data.check.dataset %}
          {{data.check.dataset}}
        {% else %}
          {{data.check.dataSubject}}
        {% endif %}
      </span>
      <h1 class="govuk-heading-l">
        {{pageName}}
      </h1>

      {# <h2 class="govuk-heading-m">
        Errors that have been fixed automatically
      </h2> #}

      {# {{ govukSummaryList({
        rows: [
          {
            key: {
              text: "Date format"
            },
            value: {
              text: "405 rows had an incorrect date format. We changed the format to X."
            }
          },
          {
            key: {
              text: "Thing"
            },
            value: {
              text: "Detail"
            }
          }
        ]
      }) }} #}

      {# <p>We recommend changing your data to follow the corrections made above.</p> #}

      {% if data.hasErrors %}

        <ul class="govuk-list govuk-list--bullet">
          <li>
            21 locations are not in England
          </li>
          <li>
            3 last updated dates are in the future
          </li>
          <li>
            1 record has a missing reference
          </li>
        </ul>
      {% else %}
        {# <p>We have transformed some of your data.</p> #}
      {% endif %}

  </div>
</div>

{% set errorSiteReference %}
  {{ govukInsetText({
    classes: "app-inset-text---error",
    html: '<p class="app-instruction-text">Reference is missing</p>'
  }) }}
{% endset %}

{% set errorLocation %}
  {{ govukInsetText({
    classes: "app-inset-text---error",
    html: '<p class="app-inset-text__value">456 Elm St, Town, Country</p> <p class="app-inset-text__error">Location is not in England</p>'
  }) }}
{% endset %}

{% set errorDate %}
  {{ govukInsetText({
    classes: "app-inset-text---error",
    html: '<p class="app-inset-text__value">20 May 2025</p> <p class="app-inset-text__error">Date must be in today or in the past</p>'
  }) }}
{% endset %}


{% if data.hasErrors %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">

      <h2 class="govuk-heading-m">
        Records with errors
      </h2>

      <div class="app-scrollable-container">
        {{ govukTable({
  head: [
    {
      text: "Row Number",
      classes: "govuk-!-width-one-half"
    },
    {
      text: "Site reference"
    },
    {
      text: "Site name"
    },
    {
      text: "GeoX"
    },
    {
      text: "GeoY"
    },
    {
      text: "Hectares"
    },
    {
      text: "Updated date"
    },
    {
      text: "Created date"
    },
    {
      text: "Organisation URI"
    },
    {
      text: "Site plan"
    }
  ],
  rows: [
    [
      {
        html: "1"
      },
      {
        html: "AB1234"
      },
      {
        html: "123 Main St, City, Country"
      },
      {
        html: "42.123456"
      },
      {
        html: "-71.987654"
      },
      {
        html: "3.5"
      },
      {
        html: "19 September 2023"
      },
      {
        html: "19 September 2023"
      },
      {
        html: "http://example.com/org1"
      },
      {
        html: "http://example.com/siteplan1"
      }
    ],
    [
      {
        html: "2"
      },
      {
        html: errorSiteReference
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "3"
      },
      {
        html: "CD5678"
      },
      {
        html: errorLocation
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "4"
      },
      {
        html: "CD5678"
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "5"
      },
      {
        html: "CD5678"
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: errorDate
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "6"
      },
      {
        html: "CD5678"
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "7"
      },
      {
        html: "CD5678"
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "8"
      },
      {
        html: "CD5678"
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "9"
      },
      {
        html: "CD5678"
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "10"
      },
      {
        html: "CD5678"
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ],
    [
      {
        html: "11"
      },
      {
        html: "CD5678"
      },
      {
        html: "456 Elm St, Town, Country"
      },
      {
        html: "38.987654"
      },
      {
        html: "-84.123456"
      },
      {
        html: "2.2"
      },
      {
        html: "20 September 2023"
      },
      {
        html: "18 September 2023"
      },
      {
        html: "http://example.com/org2"
      },
      {
        html: "http://example.com/siteplan2"
      }
    ]
  ]
}) }}

      </div>

  </div>
</div>
{% endif %}

<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <form novalidate method="post">

        {{ govukRadios({
          name: "check[fixErrors]",
          fieldset: {
            legend: {
              text: "Do you want to fix the errors before publishing your data?",
              classes: "govuk-fieldset__legend--m"
            }
          },
          value: data.check.fixErrors,
          items: [
            {
              value: "Yes",
              text: "Yes, I’ll upload a new version of the data"
            },
            {
              value: "No",
              text: "No, I’d like to publish the data which is correct"
            }
          ]
        }) }}

        {{ govukButton({
          text: "Continue"
        }) }}
      </form>

    </div>
  </div>
{% endblock %}
